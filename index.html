<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>TEST FINAL</title>
    <script src="/socket.io/socket.io.js"></script>
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
</head>
<body style="background: #111; color: white; text-align: center; font-family: sans-serif;">

    <h1 id="statut">BANËA - VERSION TEST 22:00</h1>
    <p>Si tu vois ce texte, le code est à jour.</p>

    <div id="zone-connexion">
        <input type="text" id="pseudo" placeholder="Ton nom...">
        <button onclick="rejoindre()">ENTRER AU LIVE</button>
    </div>

    <div id="zone-live" style="display:none;">
        <button onclick="testerMessage()" style="background: red; color: white; padding: 20px;">TESTER MESSAGE</button>
        <div id="messages" style="border: 1px solid white; height: 100px; margin: 10px;"></div>
        <div id="liste"></div>
    </div>

    <script>
        let socket;
        function rejoindre() {
            const nom = document.getElementById('pseudo').value;
            if(!nom) return alert("Pseudo vide");

            document.getElementById('zone-connexion').style.display = 'none';
            document.getElementById('zone-live').style.display = 'block';

            socket = io(); // Connexion au serveur

            socket.on('connect', () => {
                document.getElementById('statut').innerText = "✅ CONNECTÉ AU SERVEUR";
                socket.emit('join-room', { username: nom, peerId: 'test' });
            });

            socket.on('receive-message', (data) => {
                document.getElementById('messages').innerHTML += `<div>${data.user}: ${data.text}</div>`;
            });
        }

        function testerMessage() {
            const nom = document.getElementById('pseudo').value;
            socket.emit('send-message', { user: nom, text: "Ça marche !" });
        }
    </script>
</body>
</html>
